<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<title>CidiLabs 101 Participant Survey</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<link rel="stylesheet" href="../Shared Files/css/style.css" type="text/css" />
	<script type="text/javascript" src="../Shared Files/scripts/dmceFunctions.js"></script>
	<script type="text/javascript" src="../Shared Files/scripts/APIWrapper.js"></script>
	

	<script type="text/javascript">
		
		// setting the variable used to track if question has been submitted (not SCORM-related)
		var q1Submitted = false;
		/*******************************************************************************
		**
		** This function checks to see if the user has already submitted an answer to the question.
		** If it is the first time an answer has been submitted the "radio_validate" function is called.
		** Please refer to radio_validate in "interactions_assets_scripts.js" for more information.
		** 
		** If the question has been answered then the user is notified.
		**
		** Inputs:  formName - String - the id of the form to check
		**
		** Return:  None
		**
		*******************************************************************************/
		function checkQuestion(formName)
		{
			// you can't count on any one index remaining static, so for each new interaction, check to see where we are in the cmi.interactions array
			var index = retrieveDataValue("cmi.interactions._count");
			
			// Set the Interaction ID
			storeDataValue("cmi.interactions."+index+".id", "interaction_001");
			
			// Set the Interaction type for this "interaction"
			storeDataValue("cmi.interactions."+index+".type", "choice");
			
			// Set the user response
			storeDataValue("cmi.interactions."+index+".student_response", formName.answer.value); //formName
		
			// setting the correct answer for our validation on the page (not SCORM-related)
			// NOTE:  You might want to obfuscate the access to this so the answer isn't easily viewable
			var correctAnswer = "5"; //should be the same as the "value" attribute of the radio button with the correct answer
			
			
			// since we're using "correctAnswer" as a variable for the correct response, we set the Interaction's correct response to "correctAnswer"
			storeDataValue("cmi.interactions."+index+".correct_responses.0.pattern", correctAnswer);
		
			// the student_response field appears to be unsupported in Canvas, using the weighting field in place of it.
			storeDataValue("cmi.interactions."+index+".weighting", formName.answer.value);
		
			// to describe this Interaction, we'r using the actual test question
			storeDataValue("cmi.interactions."+index+".description", "{lang=en-US}The following is an example of what Interaction Type? Strongly Agree | Agree | Neither Agree nor Disagree | Disagree | Strongly Disagree");
			
			
			//check to see if the question has been submitted
			if( !q1Submitted ) 
			{
				
				//radio_validate returns a boolean: true = the user answered the question, false = the user did not answer the question (not SCORM-related)
				answerSelected = radio_validate( formName, correctAnswer, index, 'interactions' ); 

				var questionIndex = retrieveDataValue( "cmi.interactions._count" ) - 1;
				var name = retrieveDataValue ( "cmi.learner_name" );
				var split_name = name.split(",");
				var first_name = split_name[1].trim();
				var last_name = split_name[0];
				var get_uid =  retrieveDataValue ( "cmi.learner_id" );
				var uid = get_uid.split(".");
				var user_response = retrieveDataValue( "cmi.interactions."+questionIndex+".weighting" );


				let $form = document.createElement('form');
				$form.action = 'https://script.google.com/macros/s/AKfycbxY_-2frn6miQTxYR39fvqBHqx1edOi2zM7bWCNxvUBWPpAUHWA/exec';
				$form.method = 'POST';

				$form.innerHTML = '<input type="text" name="full_name" value="'+name+'">';
				$form.innerHTML += '<input type="text" name="first_name" value="'+first_name+'">';
				$form.innerHTML += '<input type="text" name="last_name" value="'+last_name+'">';
				$form.innerHTML += '<input type="text" name="uid" value="'+uid[1]+'">';
				$form.innerHTML += '<input type="text" name="course" value="SPW CidiLabs 101">';
				$form.innerHTML += '<input type="text" name="course_rating" value="'+user_response+'">';
				document.body.append($form);
				$form.submit();
				// GoToPage( 'interactions_cca_question_fb.html' );
				setTimeout("location.href = 'interactions_cca_question_fb.html';",300);
				
				// If you are interested in how we set the set the learnerResponse, please 
				// refer to the dmceFunctions.js file
				
				if(answerSelected) 
				{
					q1Submitted = true;

					document.getElementById('submit').disabled = true;
					document.getElementById('reset').disabled = true;
				}
			}
			else
			{
				//alreadyAnswered is a global variable defined in "interactions_assets_scripts.js"
				alert(alreadyAnswered);
			}
		}// end function

	</script>
</head>

<body onload="javascript:Initialize();" onunload="javascript:onUnexpectedExit ( '01' );">

	<div id="wrapper">
		<script type="text/javascript" language="javascript">
		<!--
			loadHeader("Comments From Learner - Conceptual Content");
		-->
		</script>	
	
		<!-- Main page content -->
		<div id="fullScreen">
		<h2>Feedback Survey</h2>
			<p id="heading">Question 1<br/>
				<span id="content">Do you agree/disagree with the following statement: the content of this self-paced workshop will be benefitial to my teaching.</span>
			</p>
			

				<!-- the id is the formName that should get passed to the JavaScript function called in the Submit button "onclick" attrib  -->
				<form id="q1" action="" onSubmit="return false;">
					
						<div><input type="radio" name="answer" value="1" onclick="enableSubmit()" tabindex="0" />Strongly Disagree<br /></div>
						<div><input type="radio" name="answer" value="2" onclick="enableSubmit()" tabindex="1" />Disagree<br /></div>
						<div><input type="radio" name="answer" value="3" onclick="enableSubmit()" tabindex="2" />Neither Agree nor Disagree<br /></div>
						<div><input type="radio" name="answer" value="4" onclick="enableSubmit()" tabindex="3" />Agree</div>
						<div><input type="radio" name="answer" value="5" onclick="enableSubmit()" tabindex="4" />Strongly Agree</div>
						<br/>
						<div>
							<input type="reset" name="reset" value="Reset" tabindex="5" />&nbsp;&nbsp;
							<input type="button" name="submit" value="Submit" onclick="checkQuestion(q1)" tabindex="5" />
							<br/><span id="feedback">&nbsp;</span>						
						</div>
				</form>
				<script type="text/javascript" >
					disableSubmit();
				</script>
		</div>		
		<!-- end main content -->
	
		<!-- Bottom page navigation -->
		<form id="navigation" action="">
			<div id="prevBtn"></div>		
		</form>

</div>
	
</body>
</html>